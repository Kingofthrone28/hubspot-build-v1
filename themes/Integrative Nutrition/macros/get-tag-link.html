<!--
  templateType: "none"
  isAvailableForNewContent: false
-->
{#
  Get a map of tags to links
  Example:

  {% from '../../macros/get-blog-link.html' import add_menu_to_dict %}
  {% set tag_menu = menu(module.menu) %}
  {% set tag_dict = {} %}
  {{ add_menu_to_dict(tag_menu, tag_dict)  }}
  {% set tag_link = tag_dict[tag] %}
#}
{% macro add_menu_to_dict(node, dict) %}
  {% if node.label %}
    {% do dict.put(node.label, node.url) %} 
  {% endif %}
  {% if node.children %}
    {% for child in node.children %}
      {{ add_menu_to_dict(child, dict) }}
    {% endfor %}
  {% endif %}
{% endmacro %}

{#
  Build a map of tags to urls and load it into JS object clientside
  Using {% require_js %} will cause this to be loaded _after_ module scripts
#}
{% macro load_tag_map(menu_node) %}
  {% set dict = {} %}
  {{ add_menu_to_dict(menu_node, dict) }}
  <script>
    IIN.blog = IIN.blog ?? {};
    IIN.blog.tagMap = {
      {%- for key, val in dict.items() %}
        '{{ key }}': '{{ val }}',
      {%- endfor %}
    };
  </script>
{% endmacro %}
